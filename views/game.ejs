<!doctype html>
<html>
  <head>
    <title>Game !</title>
  </head>
  <body>
    <ul id="messages"></ul>
    <label for="token">Token</label>
    <input type="text" id="token" name="token" value="<%= token %>" readonly><br>
    <button type="submit" id="ready-btn" name="ready-btn">Ready</button><br>
    <label for="token">Dadu 1</label>
    <input type="number" id="dice-1" name="dice-1" min="1" max="6"><br>
    <label for="token">Dadu 2</label>
    <input type="num'" id="dice-2" name="dice-2" min="1" max="6"><br>
    <button type="submit" id="first-dice-btn" name="first-dice-btn">Draw first dice</button>
    <button type="submit" id="dice-btn" name="dice-btn">Roll dice !</button>
    <button type="submit" id="answer-btn" name="answer-btn">Answer</button>
    <button type="submit" id="no-answer-btn" name="no-answer-btn">Not Answering</button>
  </body>
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script>
    $(function () {
        var token = $('#token').val();
        var socket = io('',{
          query : {
            token : token
          }
        });

        socket.on("player join",function(msg){
          console.log(msg);
        });

        socket.on("spectator join",function(msg){
          console.log("Spectator join");
        })

        socket.on("player ready",function(msg){
          console.log(msg.token + " ready");
        });

        socket.on("game ready",function(msg){
          console.log("game ready");
        });

        socket.on("cash change",function(msg){
          console.log(msg);
        });

        socket.on("update",function(msg){
          console.log(msg);
        })


        socket.on("game start",function(msg){
          console.log("Game started");
        });

        $('#ready-btn').click(function(e){
          e.preventDefault();
          socket.emit("ready");
        });

        $('#reward-btn').click(function(e){
          e.preventDefault();
          socket.emit("draw reward");
        });

        $('#first-dice-btn').click(function(e){
          e.preventDefault();
          var dice_1 = parseInt($("#dice-1").val());
          var dice_2 = parseInt($("#dice-2").val());
          console.log(dice_1);
          console.log(dice_2);
          socket.emit("first roll",{
            dice_1 : dice_1,
            dice_2 : dice_2
          });
        });

        $('#dice-btn').click(function(e){
          e.preventDefault();
          var dice_1 = parseInt($("#dice-1").val());
          var dice_2 = parseInt($("#dice-2").val());
          console.log(dice_1)
          console.log(dice_2);
          socket.emit("roll",{
            dice_1 : dice_1,
            dice_2 : dice_2
          });
        });

        $("#answer-btn").click(function(e){
          e.preventDefault();
          socket.emit("answer",{
            selected : true
          });
        });

        $("#no-answer-btn").click(function(e){
          e.preventDefault();
          console.log("not answering");
          socket.emit("answer",{
            selected : false
          })
        })


  });
  </script>
</html>